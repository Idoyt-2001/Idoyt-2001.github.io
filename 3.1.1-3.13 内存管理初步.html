<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --mermaid-theme: default; --mermaid-sequence-numbers: off; --mermaid-flowchart-curve: linear; --mermaid--gantt-left-padding: 75; --sequence-theme: simple; }


:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


/*https://github.com/AntonVanke/Typora-Cement-Theme*/
/*
字体  Font: SourceHanSans
LICENSE: https://github.com/adobe-fonts/source-han-sans/blob/master/LICENSE.txt
*/
/*
代码块字体  Code block font: Fira Code
LICENSE: https://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=OFL
*/
@media print {
    :root {
        --bg-color: var(--write-bg-color) !important;
    }

    html, body {
        background: var(--write-bg-color) !important;
    }
}

body {
    background: var(--bg-color);
    font: 100%/1.65 var(--font-family-base);
    max-width: 950px;
}

/* 内容沉底 */
content {
    bottom: 0 !important;
}

.ty-footer {
    background-color: transparent !important;
    border: 0 !important;
    right: 12px !important;
}

/* 使左侧边栏统一 */
.sidebar-menu {
    border: none !important;
}

/* 调整条 */
.typora-sidebar-resizer-bar:hover {
    border-right: 2px dashed var(--color-black);
}

#write {
    /*border-radius: var(--hover-radius);*/
    margin: 16px 16px 10% 16px;
    background: var(--write-bg-color);
    transition-duration: 0.3s;
    transform: perspective(1px) translateZ(0);
    transition-property: padding;
    /*box-shadow: 0 0 3px #c4cacf;*/
    /*max-width: 950px;*/
    /*margin: 16px auto 10%;*/
}

/* 写作区域宽度自适应 */
@media (min-width: 1000px) {
    #write {
        padding-left: 64px;
        padding-right: 64px;
        /*margin-left: 10%;*/
        /*margin-right: 10%;*/
    }
}

@media (min-width: 1270px) {
    #write {
        padding-left: 128px;
        padding-right: 128px;
        /*margin-left: 15%;*/
        /*margin-right: 15%;*/
    }
}

/* 底部结束 */
/* #write::after {
    content: "Everything has changed";
    color: var(--text-color);
    font-size: .8rem;
    font-style: italic;
    height: 1rem !important;
    text-shadow: 2px 2px 4px rgb(0 0 0 / 20%);
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translate(-50%);
    z-index: 5;
} */

/*标题*/
#write h1,
#write h2,
#write h3,
#write h4,
#write h5,
#write h6 {
    color: var(--title-color);
    font-family: var(--font-family-base);
    font-weight: 700;
    line-height: 1.25;
    margin: 0 0 1rem 0;
}

#write h1 {
    font-size: 3rem;
}

#write h2 {
    font-size: 2.5rem;
}

#write h3 {
    font-size: 2rem;
}

#write h4 {
    font-size: 1.5rem;
}

#write h5 {
    font-size: 1.2rem;
}

#write h6 {
    font-size: 0.8rem;
}

#write .md-heading:before {
    color: var(--md-heading-before-color);
}

/*表格*/
#write table:not(.md-grid-board) {
    /* background-color: var(--table-first-bg-color); */
    border: 1px solid var(--table-border-color);
    margin-top: 20px;
    margin-left: 10%;
    margin-right: 10%;
    width: 80%;
    border-collapse: separate;
    border-radius: var(--hover-radius);
}


#write table:not(.md-grid-board) td {
    padding: 12px 24px;
    border-left: 1px dashed var(--table-border-color);
    border-bottom: 1px dashed var(--table-border-color);
    transition: background-color 0.3s ease-out;
}

#write table:not(.md-grid-board) th {
    padding: 12px 24px;
    border-left: 1px solid var(--table-border-color);
    border-bottom: 1px solid var(--table-border-color);
    transition: background-color 0.3s ease-out;
}

#write table thead tr {
    background-color: var(--table-first-bg-color);
}

#write table:not(.md-grid-board) td:hover,
#write table:not(.md-grid-board) th:hover {
    background-color: rgba(0, 0, 0, .1);
    text-shadow: 2px 2px 4px rgb(0 0 0 / 20%);
}

#write table:not(.md-grid-board) tr td:first-child,
#write table:not(.md-grid-board) tr th:first-child {
    border-left: 0;
}

#write table:not(.md-grid-board) tr:last-child td {
    border-bottom: 0;
}

/* 左上角表格 */
#write table:not(.md-grid-board) tr:first-child th:first-child {
    border-top-left-radius: var(--hover-radius);
}


/* 右上角表格 */
#write table:not(.md-grid-board) tr:first-child th:last-child {
    border-top-right-radius: var(--hover-radius);
}

/* 左下角表格 */
#write table:not(.md-grid-board) tr:last-child td:first-child {
    border-bottom-left-radius: var(--hover-radius);
}

/* 右下角表格 */
#write table:not(.md-grid-board) tr:last-child td:last-child {
    border-bottom-right-radius: var(--hover-radius);
}

/*一个投机取巧的方法，不过我觉得还挺好看*/
#write table:not(.md-grid-board) thead tr:first-child th:first-child {
    /*border-bottom-left-radius: var(--hover-radius) !important;*/
}

#write table:not(.md-grid-board) thead tr:first-child th:last-child {
    /*border-bottom-right-radius: var(--hover-radius) !important;*/
}

/*
#write table:not(.md-grid-board):hover {
    border-radius: var(--hover-radius);
}
#write table:not(.md-grid-board) tr:first-child th:first-child:hover {
    border-top-left-radius: var(--hover-radius);
}

#write table:not(.md-grid-board) tr:first-child th:last-child:hover {
    border-top-right-radius: var(--hover-radius);
}

#write table:not(.md-grid-board) tr:last-child td:first-child:hover {
    border-bottom-left-radius: var(--hover-radius);
}

#write table:not(.md-grid-board) tr:last-child td:last-child:hover {
    border-bottom-right-radius: var(--hover-radius);
}
*/
/* 下方控制条 */
footer {
    padding-left: 15px;
}

/*详细菜单*/
content .dropdown-menu {
    border-radius: 5px;
    background: var(--dropdown-menu-color);
    box-shadow: 0 8px 10px 1px rgb(0 0 0 / 14%), 0 3px 14px 2px rgb(0 0 0 / 12%), 0 5px 5px -3px rgb(0 0 0 / 20%);
}

/* 详细菜单的分割线 */
.dropdown-menu .divider {
    border-top: 1px solid #ebebeb;
    margin-top: 6px;
    margin-bottom: 6px;
}

/* 表格编辑条 */
.ty-table-edit {
    /*overflow: hidden;*/
    /*width: 30px !important;*/
    /*height: 30px;*/
    background: var(--ty-table-edit-bg-color);
    border-radius: 15px;
    /*padding-left: 0;*/
    border: 1px solid var(--table-border-color);
    /*transition: width .5s ease-in-out, overflow 1s ease-in;*/
    box-shadow: 0 8px 10px 1px rgb(0 0 0 / 14%), 0 3px 14px 2px rgb(0 0 0 / 12%), 0 5px 5px -3px rgb(0 0 0 / 20%);
}

/*.ty-table-edit:hover {*/
/*    width: 40% !important;*/
/*    overflow: visible;*/
/*}*/

/* 表格编辑条按钮 */
.ty-table-edit button {
    margin: 0 10px !important;
    padding: 5px !important;
    border-radius: 5px !important;
}

/* 表格编辑条按钮状态 */
.ty-table-edit button:active,
.ty-table-edit button:hover,
.ty-table-edit button.active {
    background: none !important;
    border: none !important;
    box-shadow: 0 8px 10px 1px rgb(0 0 0 / 14%), 0 3px 14px 2px rgb(0 0 0 / 12%), 0 5px 5px -3px rgb(0 0 0 / 20%);
}

/*段落*/
#write > p,
#write > pre,
#write > ul {
    margin-bottom: 1.25rem;
}

/* mark 高亮 */
mark {
    background: var(--mark-bg-color) !important;
    border-radius: 1em !important;
    color: var(--mark-text-color);
    padding: 2px 4px;
    margin: 1px 2px;
    font-weight: 400;
    transform: perspective(1px) translateZ(0);
    transition-duration: 0.2s;
    transition-property: padding, margin;
}

/* 高亮 hover */
mark:hover {
    padding: 4px 8px;
    margin: 2px 4px;
}

mark span {
    white-space: nowrap;
}

/*行内代码*/
#write :not(pre) > code {
    font-family: var(--font-family-monospace);
    font-weight: 300;
    color: var(--inline-code-color);
    padding: 0 4px;
    background-color: #e6e6e6;
    border-radius: 3px;
}

#write :not(pre) > code:hover {
    color: var(--color-tertiary);
}

/*行内公式预览*/
.md-inline-math {
    margin-left: .3rem;
    margin-right: .3rem;
}

.md-inline-math .md-meta {
    color: #0e82c2;
}

#math-inline-preview .md-arrow {
    opacity: .3;
}

#math-inline-preview #math-inline-preview-content {
    color: var(--color-on-primary-container);
}

/*链接*/
a {
    font-weight: 700;
    color: var(--link-color);
    text-decoration: none;
    transform: perspective(1px) translateZ(0);
    transition-duration: 0.2s;
    transition-property: transform;
}

a:hover {
    color: var(--link-color);
    text-decoration: underline;
}

/*yaml标签*/
.md-meta-block {
    background: var(--meta-block-bg-color) !important;
    color: var(--meta-block-font-color);
    margin: 20px 0;
    padding: 12px 24px;
    overflow: auto;
    border-radius: var(--radius);
    transform: perspective(1px) translateZ(0);
    transition-duration: 0.2s;
    transition-property: border-radius;
}

.md-meta-block:hover {
    border-radius: var(--hover-radius);
}

/*Latex*/
.md-hover-tip .md-arrow:after {
    background: var(--color-secondary-container);

}

.md-hover-tip .code-tooltip-content {
    background: var(--color-secondary-container);
}

/*角标*/
sup.md-footnote {
    background: transparent;
    color: var(--link-color);
}

/*目录*/
.md-toc {
    font-size: 0.95rem;
}

/*引用*/
blockquote {
    color: var(--blockquote-font-color);
    background-color: var(--blockquote-bg-color);
    border-radius: 14px;
    padding: 1.5rem 1rem;
    transform: perspective(1px) translateZ(0);
    transition-duration: 0.2s;
    transition-property: border-radius;
}

blockquote:hover {
    border-radius: 3px;
}

/* 图片 FIXME: 无法显示 */
#write img::after {
    content: attr(alt);
    color: var(--text-color);
    position: absolute;
    top: 10px;
    right: 15px;
    z-index: 999;
}

/* 复选框 */
#write input[type=checkbox] {
    cursor: inherit;
    height: 100%;
    width: 1rem;
    margin: 0 -30px;
    z-index: 1;
}

/*
 侧边栏
*/
#outline-content::-webkit-scrollbar,
#file-library::-webkit-scrollbar {
    display: none;
}

#outline-content .outline-item,
.file-library-file-node {
    border-radius: 0 16px 16px 0;
    margin-left: -28px;
    margin-right: 0 !important;
    text-overflow: ellipsis;
    padding-top: 5px;
    padding-bottom: 5px;
    border-left: 28px solid transparent;
    padding-right: 28px;
    /*border-right: 28px solid transparent;*/
    transition: border-radius, width .15s cubic-bezier(0.4, 0, 0.2, 1), margin .15s cubic-bezier(0.4, 0, 0.2, 1), width .15s cubic-bezier(0.4, 0, 0.2, 1);
}

#outline-content .outline-item:hover,
.file-library-file-node:hover {
    opacity: 1 !important;
    border-radius: 0 16px 16px 0;
    background-color: var(--sidebar-hover-bg-color);
}

#outline-content .outline-item-active,
.file-library-file-node.active {
    border-radius: 0 16px 16px 0;
    background-color: var(--sidebar-active-bg-color);
}

#outline-content .outline-item:not(.outline-item-active),
.file-library-file-node:not(.active) {
    opacity: .6;
}

#file-library-list .file-list-item:hover {
    opacity: 1 !important;
    box-shadow: inset 1px 0 0 #dadce0, inset -1px 0 0 #dadce0, 0 1px 2px 0 rgb(60 64 67 / 30%), 0 1px 3px 1px rgb(60 64 67 / 15%);
}

#file-library-list .file-list-item:not(.active) {
    opacity: .6;
}

#file-library-list .file-list-item.active {
    background-color: var(--sidebar-active-bg-color);
}

/* 树文件列表 */
.file-tree-node.active > .file-node-background {
    border: none !important;
    background: none !important;
}

/* .use-file-tree-style .file-library-file-node:hover {
    opacity: 1 !important;
    box-shadow: inset 1px 0 0 #dadce0, inset -1px 0 0 #dadce0, 0 1px 2px 0 rgb(60 64 67 / 30%), 0 1px 3px 1px rgb(60 64 67 / 15%);
} */

/* 搜索框 */
.file-library-search {
    height: 60px;

}

#file-library-search-panel {
    padding-bottom: 10px;
}

#file-library-search-input {
    opacity: .8;
    padding: 10px 10px;
    background-color: var(--sidebar-active-bg-color);
    border-radius: 8px;
    border: 1px solid transparent;
    transition: background, padding 200ms ease-in, width 200ms ease-out;
}

#file-library-search-input:focus {
    background: var(--file-library-search-input-focus-color);
    padding: 15px 10px;
    border: 1px solid transparent;
    box-shadow: 0 1px 1px 0 rgb(65 69 73 / 30%), 0 1px 3px 1px rgb(65 69 73 / 15%);
}

#close-outline-filter-btn,
#filesearch-word-option-btn,
#filesearch-regexp-option-btn,
#filesearch-case-option-btn {
    transition: padding 200ms ease-in-out;
}

#file-library-search-input:focus ~ #close-outline-filter-btn,
#file-library-search-input:focus ~ #filesearch-word-option-btn,
#file-library-search-input:focus ~ #filesearch-regexp-option-btn,
#file-library-search-input:focus ~ #filesearch-case-option-btn {
    padding-top: 5px;
    text-shadow: 2px 2px 4px rgb(0 0 0 / 20%);
}

/* 提示界面 */
.no-collapse-outline.ty-show-notification.unibody-window content,
.no-collapse-outline.ty-show-notification.unibody-window content #typora-source,
.no-collapse-outline.ty-show-notification content,
.no-collapse-outline.ty-show-notification content #typora-source {
    top: 28px !important;
}

.native-window.ty-show-notification.unibody-window content,
.native-window.ty-show-notification.unibody-window content #typora-source,
.native-window.ty-show-notification content,
.native-window.ty-show-notification content #typora-source {
    top: 0 !important;
}

.md-notification-container {
    display: flex;
    top: 10%;
    width: 30%;
    left: 70% !important;
    padding-top: 0 !important;
    border-right: 5px solid var(--color-primary);
    background-color: var(--bg-color);
    flex-direction: row;
    border-top-left-radius: var(--hover-radius);
    border-bottom-left-radius: var(--hover-radius);
    box-shadow: 0 1px 1px 0 rgb(65 69 73 / 30%), 0 1px 3px 1px rgb(65 69 73 / 15%);
}

.md-notification-container .md-notification-content {
    display: block;
}

.md-notification-container .btn-default {
    background: none;
    color: var(--link-color);
    margin-right: 30px;
}

/*TODO:导出时的动画*/
/*.md-notification-container #md-notification div {*/
/*    display: block !important;*/
/*}*/

/* 模态框 */
#common-dialog.modal {
    overflow-y: hidden;
    background-color: rgba(55, 55, 55, .4);
}

.modal .modal-dialog {

    margin: 30% auto;
}

.modal .modal-content {
    border-radius: var(--hover-radius);
    padding: 10px;
}

.modal .modal-title {
    font-size: 1.2rem;
    font-weight: 600;
}

.modal .btn {
    color: var(--link-color);
    background: none;
}

.modal .btn:hover {
    font-weight: 600;
}

.modal .btn:focus {
    outline: thin dotted;
}

/*-----------------------------------------
设置页面
----------------------------------------- */
.megamenu-menu-header {
    border: none;
    color: var(--text-color);
}

.megamenu-menu-header #megamenu-back-btn,
.megamenu-menu-header .megamenu-menu-header-title-back,
.megamenu-menu-header .megamenu-menu-header-title-menu {
    color: var(--text-color);
}

.megamenu-menu-header:hover #megamenu-back-btn {
    color: var(--link-color);
}

.megamenu-menu {
    background-color: var(--bg-color);
    color: var(--text-color);
    box-shadow: none !important;
}

.megamenu-menu #m-saved i {
    display: none !important;
}

/* 没有保存时 */
.megamenu-menu #m-save {
    color: var(--color-error);
}

/* 已保存 */
.megamenu-menu #m-saved {
    color: var(--color-primary);
}

.megamenu-menu-list a {
    padding-top: 0;
    border-radius: 0 16px 16px 0;
    border-left: 28px solid transparent;
    border-right: 28px solid transparent;
    transition: border-radius, width .15s cubic-bezier(0.4, 0, 0.2, 1), margin .15s cubic-bezier(0.4, 0, 0.2, 1), width .15s cubic-bezier(0.4, 0, 0.2, 1);
}

.megamenu-menu-list {
    background-color: var(--bg-color);
}

.megamenu-menu-list a:hover,
.file-library-file-node:hover {
    opacity: 1 !important;
    border-radius: 0 16px 16px 0;
    background-color: var(--sidebar-hover-bg-color) !important;
}

.megamenu-menu-list a.active {
    border-radius: 0 16px 16px 0;
    background-color: var(--sidebar-active-bg-color) !important;
}

.megamenu-menu-list a:not(.active) {
    opacity: .6;
}

/* 主内容区 */
header {
    background-color: var(--bg-color);
    background-image: none !important;
}

#megamenu-content {
    background-color: var(--bg-color);
    background-image: none !important;
}

.megamenu-section#megamenu-section-open {
    margin: 40px 20px;
    padding: 20px;
    /* background-color: var(--write-bg-color); */
    border-radius: var(--hover-radius);
}

.megamenu-section .long-btn {
    border-radius: 50px;
    background: var(--long-btn-color);
    box-shadow: var(--long-btn-normal);
    margin: 30px;
    border: none;
}

.megamenu-section .long-btn:hover {
    border-radius: 50px;
    background: var(--long-btn-hover-bg);
    box-shadow: var(--long-btn-hover);
}

.megamenu-section .long-btn:active {
    border-radius: 50px;
    background: #e6eef4;
    box-shadow: inset 5px 5px 10px #c4cacf,
    inset -5px -5px 10px #ffffff;
}

/* 搜索框 */
#recent-file-panel-search-input {
    opacity: .8;
    margin: 10px 0;
    padding: 10px 10px;
    background-color: var(--sidebar-active-bg-color);
    border-radius: 8px;
    border: 1px solid transparent;
    transition: background, padding 200ms ease-in, width 200ms ease-out;
}

#recent-file-panel-search-input:focus {
    background: var(--file-library-search-input-focus-color);
    padding: 20px 10px;
    border: 1px solid transparent;
    box-shadow: 0 1px 1px 0 rgb(65 69 73 / 30%), 0 1px 3px 1px rgb(65 69 73 / 15%);
}

#recent-file-panel-action-btn-container {
    margin-right: 30px;
    transition: background, padding 200ms ease-in, width 200ms ease-out;
}

#recent-file-panel-search-input:focus + #recent-file-panel-action-btn-container {
    padding-top: 5px;
}

#recent-file-panel-action-btn {
    color: var(--text-color);
    outline: none;
    border-radius: 19px;
    background: var(--long-btn-color);
    box-shadow: var(--recent-file-panel-action-btn);
    margin-top: 10px;
    padding-left: 10px;
    padding-right: 10px;
    border: none;
}

#recent-file-panel-action-btn:hover {
    border-radius: 19px;
    background: var(--recent-file-panel-action-btn-hover-bg);
    box-shadow: var(--recent-file-panel-action-btn-hover);
    margin-top: 10px;
    padding-left: 10px;
    padding-right: 10px;
    border: none;
}

#recent-file-panel-action-btn:active {
    border-radius: 19px;
    background: var(--long-btn-color);
    box-shadow: var(--recent-file-panel-action-btn-active-bg);
    margin-top: 10px;
    padding-left: 10px;
    padding-right: 10px;
    border: none;
}

/* 最近文件列表 */
.recent-file-item:hover {
    color: var(--color-black);
    font-weight: 400;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: var(--recent-file-panel-n-bg-color);
    color: var(--recent-file-panel-n-color);
}

/*
导出网页 TODO
*/
.typora-export .outline-item-wrapper {
    border-radius: 0 16px 16px 0;
    margin-left: -28px;
    margin-right: 0 !important;
    text-overflow: ellipsis;
    padding-top: 5px;
    padding-bottom: 5px;
    border-left: 28px solid transparent;
    border-right: 28px solid transparent;
    transition: border-radius, width .15s cubic-bezier(0.4, 0, 0.2, 1), margin .15s cubic-bezier(0.4, 0, 0.2, 1), width .15s cubic-bezier(0.4, 0, 0.2, 1);
}

.typora-export .outline-item-wrapper:hover {
    opacity: 1 !important;
    border-radius: 0 16px 16px 0;
    background-color: var(--sidebar-hover-bg-color);
}

.typora-export .outline-item-active {
    border-radius: 0 16px 16px 0;
    background-color: var(--sidebar-active-bg-color);
}

.typora-export .outline-item-wrapper:not(.outline-item-active) {
    opacity: .6;
}

body.typora-export {
    max-width: none !important;
}

/*防止超链接点不到*/
.typora-export .outline-item-wrapper .outline-label {
    width: 100%;
}

/*
Mac 上的一些细节优化
*/
/*Macos 的侧边栏边框*/
.mac-os-11 .sidebar-tabs {
    border-bottom: none !important;
}

/*侧边栏搜索框*/
.mac-os-11 #file-library-search-input {
    padding: 5px 10px;
}

.mac-os-11 #file-library-search-input:focus {
    padding: 10px 10px;
}

.mac-os-11 #ty-sidebar-search-back-btn {
    padding-top: 3px;
}

.mac-os-11 #file-library-search-input:focus ~ #ty-sidebar-search-back-btn {
    padding-top: 8px;
}

/*一个偶然发现的置顶功能*/
.always-on-top #w-unpin {
    background: var(--titlebar-top-bg-color);
}

#top-titlebar .toolbar-icon.btn.hover, #top-titlebar .toolbar-icon.btn:hover {
    background-color: var(--titlebar-bg-color);
}

/*源码模式按钮背景颜色*/
.typora-sourceview-on #toggle-sourceview-btn {
    background: var(--active-file-bg-color);
    opacity: .2;
    transition: opacity, padding 200ms ease-in-out;
}

.typora-sourceview-on #toggle-sourceview-btn:hover {
    background: var(--active-file-bg-color);
    opacity: .5;
}@import "";

:root {
    /*
    Color
    Material 3 标准颜色
    */
    --color-white: #fff;
    --color-black: #000;

    --color-primary: #6750A4;
    --color-on-primary: #FFFFFF;
    --color-primary-container: #EADDFF;
    --color-on-primary-container: #21005D;

    --color-secondary: #625B71;
    --color-on-secondary: #FFFFFF;
    --color-secondary-container: #EADDFF;
    --color-on-secondary-container: #1D192B;

    --color-tertiary: #0e82c2;
    --color-on-tertiary: #FFFFFF;
    --color-tertiary-container: #FFD8E4;
    --color-on-tertiary-container: #31111D;

    --color-error: #B3261E;
    --color-on-error: #FFFFFF;
    --color-error-container: #F9DEDC;
    --color-on-error-container: #410E0B;

    /* 
    系统变量
    Typora base.css/base-control.css/windows.css 所带的变量
    */
    /* 背景颜色 */
    --bg-color: #f6f8fc;
    /* 文字颜色 */
    --text-color: #333333;
    /* 选择的文字背景颜色 */
    --select-text-bg-color: #B5D6FC;
    /* 选择的文字颜色 */
    --select-text-font-color: auto;
    /* 侧边栏颜色 */
    --side-bar-bg-color: var(--bg-color);
    /* 菜单边框 */
    --window-border: 1px solid #e9e9e9;
    /* 侧边栏活跃文件背景颜色 */
    --active-file-bg-color: #eee;
    /* 侧边栏活跃文件文字颜色 */
    --active-file-text-color: inherit;
    /* 侧边栏活跃文件边框颜色 */
    --active-file-border-color: #777;
    /* 侧边栏宽度 */
    --sidebar-width: 256px;
    /*代码块背景*/
    --code-block-bg-color: #f6f7f8;
    /*latex背景*/
    --rawblock-edit-panel-bd: var(--code-block-bg-color);

    /* 
    主题变量
    主题所设置的变量
    */
    /* 基础字体 */
    --font-family-base: "思源黑体 CN", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    /*等宽代码字体*/
    --font-family-monospace: "Fira Code", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    /* 编辑区背景颜色 */
    --write-bg-color: var(--color-white);
    /* 圆角 */
    --radius: 5px;
    /* 圆角 hover */
    --hover-radius: 12px;
    /* 标题颜色 */
    --title-color: #1f1f1f;
    /* 链接颜色 */
    --link-color: #0842a0;
    /* 标题前的指示标志 */
    --md-heading-before-color: var(--link-color);
    /*右键菜单*/
    --dropdown-menu-color: var(--color-white);
    /*菜单按钮*/
    --long-btn-color: #e6eef4;
    --long-btn-normal: 10px 10px 20px #c4cacf, -10px -10px 20px #ffffff;
    --long-btn-hover-bg: linear-gradient(145deg, #cfd6dc, #f6ffff);
    --long-btn-hover: 5px 5px 10px #c4cacf, -5px -5px 10px #ffffff;
    --recent-file-panel-action-btn: 4px 4px 9px #d6dde3, -4px -4px 9px #f6ffff;
    --recent-file-panel-action-btn-hover: 4px 4px 9px #d6dde3, -4px -4px 9px #f6ffff;
    --recent-file-panel-action-btn-hover-bg: linear-gradient(145deg, #cfd6dc, #f6ffff);
    --recent-file-panel-action-btn-active-bg: inset 4px 4px 9px #d6dde3, inset -4px -4px 9px #f6ffff;

    /*高亮背景颜色*/
    --mark-bg-color: var(--color-primary-container);
    /*高亮文字颜色*/
    --mark-text-color: var(--color-black);
    /* 引用字体颜色 */
    --blockquote-font-color: #777777;
    /* 引用背景颜色 */
    --blockquote-bg-color: #dfe2e5;

    /* 行内代码颜色 */
    --inline-code-color: #008f83;
    /*表格首行背景颜色*/
    --table-first-bg-color: #f8f9fa;
    /*表格编辑条颜色*/
    --ty-table-edit-bg-color: var(--color-white);
    /*表格其他行背景颜色*/
    /* --table-other-bg-color: var(--color-tertiary-container); */

    /* 表格边框颜色  */
    --table-border-color: #e1e3e1;

    /* YAML 背景颜色 */
    --meta-block-bg-color: var(--color-tertiary-container);
    /* YAML 文字颜色 */
    --meta-block-font-color: var(--color-on-tertiary-container);

    /* active 背景 */
    --sidebar-active-bg-color: #d3e3fd;
    /* --sidebar-active-bg-color: #fce8e6; */
    /* hover 背景 */
    --sidebar-hover-bg-color: rgba(32, 33, 36, 0.059);

    /*搜索栏 focus 颜色*/
    --file-library-search-input-focus-color: var(--color-white);
    /*最近文件单数背景*/
    --recent-file-panel-n-bg-color: #c0c0c0;
    --recent-file-panel-n-color: var(--color-black);

    /*操作按钮*/
    --titlebar-bg-color: #EDEDED;
    --titlebar-top-bg-color: var(--color-primary-container);

}

/*
代码块
*/
.md-fences {
    background-color: var(--code-block-bg-color);
    border-radius: var(--radius);
    transform: perspective(1px) translateZ(0);
    transition-duration: 0.3s;
    transition-property: border-radius, padding, box-shadow;
    transition-timing-function: ease-in-out;
    /*box-shadow: 0px 8px 10px 1px rgb(0 0 0 / 14%), 0px 3px 14px 2px rgb(0 0 0 / 12%), 0px 5px 5px -3px rgb(0 0 0 / 20%);*/
    /*box-shadow: 0 1px 1px 0 rgba(0, 28, 36, .2);*/
}

.md-fences::selection {
    color: var(--select-text-bg-color);
}

/* .md-fences:hover::before {
    content: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NCIgaGVpZ2h0PSIxNCIgdmlld0JveD0iMCAwIDU0IDE0Ij4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMSAxKSI+CiAgICAgICAgPGNpcmNsZSBjeD0iNiIgY3k9IjYiIHI9IjYiIGZpbGw9IiNGRjVGNTYiIHN0cm9rZT0iI0UwNDQzRSIgc3Ryb2tlLXdpZHRoPSIuNSI+PC9jaXJjbGU+CiAgICAgICAgPGNpcmNsZSBjeD0iMjYiIGN5PSI2IiByPSI2IiBmaWxsPSIjRkZCRDJFIiBzdHJva2U9IiNERUExMjMiIHN0cm9rZS13aWR0aD0iLjUiPjwvY2lyY2xlPgogICAgICAgIDxjaXJjbGUgY3g9IjQ2IiBjeT0iNiIgcj0iNiIgZmlsbD0iIzI3QzkzRiIgc3Ryb2tlPSIjMUFBQjI5IiBzdHJva2Utd2lkdGg9Ii41Ij48L2NpcmNsZT4KICAgIDwvZz4KPC9zdmc+');
    position: absolute;
    top: 15px;
    left: 20px;
    z-index: 5;
} */

/* .md-fences:hover::before {
    content: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTQiIGhlaWdodD0iMTQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8Y2lyY2xlIGlkPSJzdmdfMiIgc3Ryb2tlLXdpZHRoPSIwLjUiIHN0cm9rZT0iI0UwNDQzRSIgZmlsbD0iI0ZGNUY1NiIgcj0iNiIgY3k9IjciIGN4PSI2LjgwNzY5MyIvPgogICAgPGNpcmNsZSBpZD0ic3ZnXzMiIHN0cm9rZS13aWR0aD0iMC41IiBzdHJva2U9IiNERUExMjMiIGZpbGw9IiNGRkJEMkUiIHI9IjYiIGN5PSI3IiBjeD0iMjYuODA3NjkzIi8+CiAgICA8Y2lyY2xlIGlkPSJzdmdfNCIgc3Ryb2tlLXdpZHRoPSIwLjUiIHN0cm9rZT0iIzFBQUIyOSIgZmlsbD0iIzI3QzkzRiIgcj0iNiIgY3k9IjciIGN4PSI0Ni44MDc2OTMiLz4KICAgIDxsaW5lIHRyYW5zZm9ybT0icm90YXRlKDQ1IDYuNzM4NTUxNjE2NjY4NzA2LDcuMDg3MTQwNTYwMTUwMTQ2KSAiIHN0cm9rZT0iIzU1NSIgc3Ryb2tlLWxpbmVjYXA9Im51bGwiCiAgICAgICAgICBzdHJva2UtbGluZWpvaW49Im51bGwiIGlkPSJzdmdfMTMiIHkyPSI3LjA4NzE0MSIgeDI9IjExLjU3MzIyMiIgeTE9IjcuMDg3MTQxIiB4MT0iMS45MDM4ODIiCiAgICAgICAgICBmaWxsLW9wYWNpdHk9Im51bGwiIHN0cm9rZS1vcGFjaXR5PSJudWxsIiBmaWxsPSJub25lIi8+CiAgICA8bGluZSB0cmFuc2Zvcm09InJvdGF0ZSgtNDUgNi43Mzg1NTE2MTY2Njg3MDIsNy4wODcxNDA1NjAxNTAxNDYpICIgc3Ryb2tlPSIjNTU1IiBzdHJva2UtbGluZWNhcD0ibnVsbCIKICAgICAgICAgIHN0cm9rZS1saW5lam9pbj0ibnVsbCIgaWQ9InN2Z18xNSIgeTI9IjcuMDg3MTQxIiB4Mj0iMTEuNTczMjIyIiB5MT0iNy4wODcxNDEiIHgxPSIxLjkwMzg4MiIKICAgICAgICAgIGZpbGwtb3BhY2l0eT0ibnVsbCIgc3Ryb2tlLW9wYWNpdHk9Im51bGwiIGZpbGw9Im5vbmUiLz4KICAgIDxsaW5lIHN0cm9rZT0iIzU1NSIgc3Ryb2tlLWxpbmVjYXA9Im51bGwiIHN0cm9rZS1saW5lam9pbj0ibnVsbCIgaWQ9InN2Z18xNiIgeTI9IjcuMDg3MTQxIiB4Mj0iMzEuNzY1NTAzIgogICAgICAgICAgeTE9IjcuMDg3MTQxIiB4MT0iMjIuMDk2MTYyIiBmaWxsLW9wYWNpdHk9Im51bGwiIHN0cm9rZS1vcGFjaXR5PSJudWxsIiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCB0cmFuc2Zvcm09InJvdGF0ZSg5MCA0NS42Nzc3Njg3MDcyNzUzOSw2LjMwMTg5ODQ3OTQ2MTY3NCkgIiBpZD0ic3ZnXzE4IgogICAgICAgICAgZD0ibTQ1LjI5MzE1MSw2LjY4NjUxNGwwLC0wLjc2OTIzMWwwLjc2OTIzMSwwLjc2OTIzMWwtMC43NjkyMzEsMHoiIGZpbGwtb3BhY2l0eT0ibnVsbCIgc3Ryb2tlLW9wYWNpdHk9Im51bGwiCiAgICAgICAgICBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzU1NSIgZmlsbD0ibm9uZSIvPgogICAgPHBhdGggdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDQ3Ljk4NTQ1ODM3NDAyMzQ0NSw4LjgwMTg5ODAwMjYyNDUxKSAiIGlkPSJzdmdfMTkiCiAgICAgICAgICBkPSJtNDcuNjAwODQyLDkuMTg2NTE0bDAsLTAuNzY5MjNsMC43NjkyMywwLjc2OTIzbC0wLjc2OTIzLDB6IiBmaWxsLW9wYWNpdHk9Im51bGwiIHN0cm9rZS1vcGFjaXR5PSJudWxsIgogICAgICAgICAgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiM1NTUiIGZpbGw9Im5vbmUiLz4KPC9zdmc+");
    position: absolute;
    top: 10px;
    left: 15px;
    z-index: 5;
} */
.md-fences:hover,
.auto-suggest-for-fences:hover {
    border-radius: var(--hover-radius);
    /* padding-top: 15px; */
    /* padding-bottom: 15px; */
    /* box-shadow: 0 20px 40px rgb(0 0 0 / 55%); */
}

.CodeMirror.cm-s-inner {
    border-radius: 15px;
    padding: 15px 10px 10px 10px;
}

.md-fences:hover::after {
    content: attr(lang);
    transition-duration: 200ms;
    color: var(--color-tertiary);
    text-shadow: 2px 2px 4px rgb(0 0 0 / 20%);
    font-size: .8rem;
    font-style: italic;
    position: absolute;
    top: 10px;
    right: 15px;
    z-index: 999;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid var(--text-color) !important;
}

.cm-s-inner .CodeMirror-gutters {
    color: #404b53;
    background-color: transparent;
    border-right: 0
}

.cm-s-inner .CodeMirror-linenumber {
    color: #6d8a88
}

.cm-s-inner div.CodeMirror-selected {
    background: #e0e0e0
}

.cm-s-inner .CodeMirror-line::selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span > span::selection {
    background: #e0e0e0
}

.cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
    background: #e0e0e0
}

.cm-s-inner .CodeMirror-guttermarker {
    color: #ac4142
}

.cm-s-inner .CodeMirror-guttermarker-subtle {
    color: #b0b0b0
}

.cm-s-inner .CodeMirror-linenumber {
    color: #b0b0b0
}

.cm-s-inner .CodeMirror-linenumbers {
    background-color: var(--code-block-bg-color)
}

.cm-s-inner .CodeMirror-cursor {
    border-left: 1px solid #505050
}

.cm-s-inner span.cm-comment {
    color: #8f5536
}

.cm-s-inner span.cm-atom {
    color: #aa759f
}

.cm-s-inner span.cm-number {
    color: #aa759f
}

.cm-s-inner span.cm-attribute,
.cm-s-inner span.cm-property {
    color: #90a959
}

.cm-s-inner span.cm-keyword {
    color: #ac4142
}

.cm-s-inner span.cm-string {
    color: #f4bf75
}

.cm-s-inner span.cm-variable {
    color: #90a959
}

.cm-s-inner span.cm-variable-2 {
    color: #6a9fb5
}

.cm-s-inner span.cm-def {
    color: #d28445
}

.cm-s-inner span.cm-bracket {
    color: #202020
}

.cm-s-inner span.cm-tag {
    color: #ac4142
}

.cm-s-inner span.cm-link {
    color: #aa759f
}

.cm-s-inner span.cm-error {
    /*background: #ac4142;*/
    color: var(--color-error)
}

.cm-s-inner .CodeMirror-matchingbracket {
    color: #f5f5f5 !important;
    background-color: #6a9fb5 !important
}



mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG2"] path[data-c], mjx-container[jax="SVG2"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						}
</style><title>3.1.1~3.13 内存管理初步.</title>
</head>
<body class='typora-export os-windows monocolor-emoji'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='311-内存管理的基本原理和要求'><span>3.1.1 内存管理的基本原理和要求</span></h1><p><strong><span>帕金森定律：</span></strong><span>不管存储器有多大，程序都可以把它填满。</span></p><p><strong><span>分层存储器体系 (memory manger)：</span></strong><span>这个体系中计算机有若干兆(MB)快速、昂贵且易失性的高速缓存(cache)，数千兆(GB)速度与价格适中且同样易失性的内存，以及几兆兆(TB)低俗、廉价、非易失性的磁盘存储，另外还有DVD、USB等可移动存储装置。操作系统的工作是将这个存储体系抽象为一个有用的模型并管理这个抽象模型。</span></p><p><strong><span>存储管理器：</span></strong><span>操作系统中管理分层存储器体系的部分。它的任务是有效地管理内存，即记录哪些内存是正在使用的，哪些内存是空闲的；在进程需要时为其分配内存，在进程使用完后释放内存。</span></p><p><strong><span>为什么需要内存：</span></strong><span>用于读写的存储单元的价格会随着其读写速度的增大而变得十分昂贵，能够满足CPU读写速度的存储单元价格更是难以接受的，以三星为例，内存的价格在16元/G左右，而固态硬盘的价格在0.3元/G。内存的带宽可达32GB/s，而固态的读写速度仅有4500MB/S。为了满足CPU的带宽需求(i5 10300H的带宽为45.8GB/s)，我们需要少量(相比外存而言)的存储空间以发挥CPU的全部性能。</span></p><p><strong><span>内存管理的主要功能：</span></strong></p><ul><li><p><span>内存空间的分配与回收：由操作系统完成主存储器空间的分配和管理，使程序员摆脱存储分配的麻烦，提高编程效率。</span></p></li><li><p><span>地址转换：在多道程序环境下，程序中的逻辑地址与内存中的物理地址不可能一致，因此存储管理必须提供地址变换功能，把逻辑地址转换成相应的物理地址。</span></p></li><li><p><span>内存空间的扩充：利用虚拟存储技术或自动覆盖技术，从逻辑上扩充内存。</span></p></li><li><p><span>内存共享：指允许多个进程访问内存的同一部分。</span></p></li><li><p><span>存储保护：保证各道作业在各自的存储空间内运行，互不干扰。</span></p></li></ul><h4 id='1-程序的链接与装入'><span>1. 程序的链接与装入</span></h4><p><span>创建进程首先要将程序和数据装入内存。将用户源程序变为可在内存中执行的程序，其步骤如下：</span></p><ul><li><p><span>编译：由编译程序将用户源代码编译成若干目标模块。</span></p></li><li><p><span>链接：由连接程序将编译后形成的一组目标模块及它们所需的库函数链接在一起，形成一个完整的装入模块。</span></p></li><li><p><span>装入：由装入程序将装入模块装入内存运行。</span></p></li></ul><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart0" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="max-width: 729px;" viewBox="-8 -8 729 310.20001220703125" aria-roledescription="flowchart-v2"><style>#mermaidChart0{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart0 .error-icon{fill:#552222;}#mermaidChart0 .error-text{fill:#552222;stroke:#552222;}#mermaidChart0 .edge-thickness-normal{stroke-width:2px;}#mermaidChart0 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart0 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart0 .marker{fill:#333333;stroke:#333333;}#mermaidChart0 .marker.cross{stroke:#333333;}#mermaidChart0 svg{font-family:sans-serif;font-size:16px;}#mermaidChart0 .label{font-family:sans-serif;color:#333;}#mermaidChart0 .cluster-label text{fill:#333;}#mermaidChart0 .cluster-label span{color:#333;}#mermaidChart0 .label text,#mermaidChart0 span{fill:#333;color:#333;}#mermaidChart0 .node rect,#mermaidChart0 .node circle,#mermaidChart0 .node ellipse,#mermaidChart0 .node polygon,#mermaidChart0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart0 .node .label{text-align:center;}#mermaidChart0 .node.clickable{cursor:pointer;}#mermaidChart0 .arrowheadPath{fill:#333333;}#mermaidChart0 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaidChart0 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart0 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart0 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart0 .cluster text{fill:#333;}#mermaidChart0 .cluster span{color:#333;}#mermaidChart0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaidChart0 :root{--mermaid-font-family:sans-serif;}#mermaidChart0 :root{--mermaid-alt-font-family:sans-serif;}</style><g><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"><g class="cluster default" id="C"><rect style="" rx="0" ry="0" x="487" y="91.4000015258789" width="226" height="111.4000015258789"></rect><g class="cluster-label" transform="translate(584, 91.4000015258789)"><foreignObject width="32" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">装入</span></div></foreignObject></g></g><g class="cluster default" id="A"><rect style="" rx="0" ry="0" x="0" y="0" width="129" height="294.2000045776367"></rect><g class="cluster-label" transform="translate(48.5, 0)"><foreignObject width="32" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">编译</span></div></foreignObject></g></g><g class="cluster default" id="B"><rect style="" rx="0" ry="0" x="179" y="7.850000381469727" width="258" height="250.65000343322754"></rect><g class="cluster-label" transform="translate(292, 7.850000381469727)"><foreignObject width="32" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">链接</span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M283,147.10000228881836L308,147.10000228881836L333,147.10000228881836" id="L-B1-B2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B1 LE-B2" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M80,55.70000076293945L129,55.70000076293945L154,55.70000076293945L179,55.70000076293945L228.89223165295505,126.4000015258789" id="L-A1-B1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A1 LE-B1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M104,147.10000228881836L129,147.10000228881836L154,147.10000228881836L179,147.10000228881836L204,147.10000228881836" id="L-A2-B1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A2 LE-B1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M77.78125,238.50000381469727L129,238.50000381469727L154,238.50000381469727L179,238.50000381469727L228.89223165295505,167.8000030517578" id="L-A3-B1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A3 LE-B1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M412,147.10000228881836L437,147.10000228881836L462,147.10000228881836L487,147.10000228881836L512,147.10000228881836" id="L-B2-C1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B2 LE-C1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M591,147.10000228881836L616,147.10000228881836L641,147.10000228881836" id="L-C1-C2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-C1 LE-C2" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-C2-38" transform="translate(664.5, 147.10000228881836)"><rect class="basic label-container" style="" rx="5" ry="5" x="-23.5" y="-20.699999809265137" width="47" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-16, -13.199999809265137)"><foreignObject width="32" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">内存</span></div></foreignObject></g></g><g class="node default default" id="flowchart-C1-37" transform="translate(551.5, 147.10000228881836)"><rect class="basic label-container" style="" rx="5" ry="5" x="-39.5" y="-20.699999809265137" width="79" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-32, -13.199999809265137)"><foreignObject width="64" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">装入程序</span></div></foreignObject></g></g><g class="node default default" id="flowchart-A1-32" transform="translate(64.5, 55.70000076293945)"><rect class="basic label-container" style="" rx="5" ry="5" x="-15.5" y="-20.699999809265137" width="31" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-8, -13.199999809265137)"><foreignObject width="16" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">库</span></div></foreignObject></g></g><g class="node default default" id="flowchart-A2-33" transform="translate(64.5, 147.10000228881836)"><rect class="basic label-container" style="" rx="5" ry="5" x="-39.5" y="-20.699999809265137" width="79" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-32, -13.199999809265137)"><foreignObject width="64" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">目标模块</span></div></foreignObject></g></g><g class="node default default" id="flowchart-A3-34" transform="translate(64.5, 238.50000381469727)"><rect class="basic label-container" style="" rx="5" ry="5" x="-13.28125" y="-20.699999809265137" width="26.5625" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-5.78125, -13.199999809265137)"><foreignObject width="11.5625" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">...</span></div></foreignObject></g></g><g class="node default default" id="flowchart-B2-36" transform="translate(372.5, 147.10000228881836)"><rect class="basic label-container" style="" rx="5" ry="5" x="-39.5" y="-20.699999809265137" width="79" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-32, -13.199999809265137)"><foreignObject width="64" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">装入模块</span></div></foreignObject></g></g><g class="node default default" id="flowchart-B1-35" transform="translate(243.5, 147.10000228881836)"><rect class="basic label-container" style="" rx="5" ry="5" x="-39.5" y="-20.699999809265137" width="79" height="41.39999961853027"></rect><g class="label" style="" transform="translate(-32, -13.199999809265137)"><foreignObject width="64" height="26.399999618530273"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">链接程序</span></div></foreignObject></g></g></g></g></g></svg></div><h5 id='1-程序的链接方式'><span>(1) 程序的链接方式：</span></h5><p><strong><span>① 静态链接：</span></strong></p><p><span>	</span><strong><span>概念：</span></strong><span>在程序运行前，先将各目标模块及它们所需的库函数链接成一个完整的装配模块，以后不再拆开。</span></p><p><span>	</span><strong><span>需要在链接时解决的问题：</span></strong></p><ul><li><p><span>修改相对地址，编译后的所有目标模块都是从0开始的相对地址，当链接成一个装入模块时要修改相对地址。</span></p></li><li><p><span>变换外部调用符号，将每个模块中所用的外部调用符号也都变换为相对地址。</span></p></li></ul><p><strong><span>② 装入时动态链接：</span></strong></p><p><span>	</span><strong><span>概念：</span></strong><span>将用户源程序编译后所得到的一组目标模块，在装入内存时，采用边装入边链接的方式。</span></p><p><span>	</span><strong><span>优点：</span></strong><span>便于修改和更新，便于实现对目标模块的共享。</span></p><p><strong><span>③ 运行时动态链接：</span></strong></p><p><span>	</span><strong><span>概念：</span></strong><span>凡在执行过程中未被用的目标模块，都不会被调入内存和被连接到装入模块上。</span></p><p><span>	</span><strong><span>优点：</span></strong><span>能加快程序的装入过程，还可节省大量的内存空间。</span></p><h5 id='2-内存装入模块装入内存的方式'><span>(2) 内存装入模块装入内存的方式</span></h5><p><strong><span>① 绝对装入：</span></strong></p><p><span>若已知某程序将要被放置在内存中的具体位置，编译程序将在编译时生成绝对(物理)地址的目标代码。之后，绝对装入程序将按照装入模块中的地址，将程序和数据装入内存。此时，程序的逻辑地址和物理地址相同，无需进一步修改。</span></p><p><span>另外，程序中所用的绝对地址，不仅可在编译或汇编时生成，也可由程序员直接赋予。通常情况下，在程序中采用的是符号地址，编译或汇编时再转换成绝对地址。</span></p><p><strong><span>适用环境：</span></strong><span>只适用于单道程序环境。</span></p><p><strong><span>特点：</span></strong></p><ul><li><p><span>程序在内存中的位置是预先知道的。</span></p></li><li><p><span>装入的地址是绝对地址。</span></p></li></ul><p><strong><span>备注：</span></strong><span>物理地址</span><span>=</span><span>绝对地址 </span><span>	</span><span>逻辑地址</span><span>=</span><span>相对地址</span></p><p><strong><span>② 可重定位装入：</span></strong></p><p><span>在多道程序环境下，多个目标模块的起始地址通常都从0开始，程序中的其他地址都是相对于起始地址的，此时应采用可重定位装入方式。根据内存的当前情况，将装入模块装入内存的适当位置。</span></p><p><strong><span>适用环境：</span></strong><span>用于多道程序环境且程序在内存中的位置不会在执行时改变。</span></p><p><strong><span>重定位：</span></strong><span>在装入时对目标程序中指令和数据地址的修改过程。</span></p><p><span>在绝对装入中，由于地址变换常在进程装入时一次性完成，故该过程可称为静态重定位。</span></p><p><strong><span>特点：</span></strong></p><ul><li><p><span>装入模块中使用逻辑地址，在真正被装入时才将逻辑地址转换为物理地址。</span></p></li><li><p><span>地址变换是装入时一次性完成的，因此程序运行期间不可移动。</span></p></li><li><p><span>装入时就必须给作业分配其所需要的所有内存空间，若没有足够的内存，则无法装入。程序运行期间也不可申请内存空间。</span></p></li></ul><p><strong><span>③ 动态运行时装入：</span></strong></p><p><span>装入程序把装入模块装入内存后，并不立即把装入模块中的相对地址转换为绝对地址，而是把这种地址转换推迟到程序真正要执行时才进行。这种方式需要一个重定位寄存器的支持。</span></p><p><strong><span>适用环境：</span></strong><span>多道程序环境且程序在内存中的位置会在运行时改变。</span></p><p><strong><span>特点：</span></strong></p><ul><li><p><span>可以将程序分配到不连续的存储区。</span></p></li><li><p><span>在程序运行前可以只装入部分代码即可投入运行，然后在程序运行期间根据需求动态分配内存。</span></p></li><li><p><span>便于程序段的共享。</span></p></li><li><p><span>装入程序将装入模块装入内存后，并不立即把装入模块中的相对地址转换为绝对地址，而是等到程序真正要执行时才进行。</span></p></li></ul><h5 id='3-实例'><span>(3) 实例</span></h5><p><strong><span>① 使用绝对装入运行单个程序</span></strong></p><p><span>有但不仅限于以下三种实现方案</span></p><p><img src="./图片资源/3-1-1_1.png" style="zoom:60%;" /></p><ul><li><p><span>方案A以前被用于大型机和一些小型计算机上，现在很少使用了。</span></p></li><li><p><span>方案B被用于一些掌上电脑和嵌入式系统中。</span></p></li><li><p><span>方案C被用于早期的个人计算机中。</span></p></li></ul><p><span>在ROM中的系统部分称为</span><strong><span>BIOS ( Basic Input Output System，基本输入输出系统 )</span></strong><span> 。方案A和C的缺点是用户程序出现的错误可能摧毁操作系统，引发灾难性后果。</span></p><p><span>当按这种方式组织操作系统时，通常同一时刻只能有一个进程在运行。一旦用户键入了一个命令，操作系统就把需要的程序从磁盘复制到内存中并执行；当进程运行结束后，操作系统在用户终端显示提示符并等待新的命令。收到新的命令后，它把新的程序装入内存，覆盖前一个程序。</span></p><p><strong><span>② 使用可重定位装入方式运行多个不相关程序 ( 以IBM360早期模型为例 )</span></strong></p><p><strong><span>方法：</span></strong><span>内存被划分为2KB的块，每个块被分配一个4位的保护键，保护键存储在CPU的特殊寄存器中。一个内存为1MB的机器只需要512个这样的4位寄存器，容量总共为256字节。PSW ( Program Status Word，程序状态字 ) 中存有一个4位码。一个运行中的进程如果访问保护键与其PSW码不同的内存，360的硬件会捕捉到这一事件。因为只有操作系统可以修改保护键，这样就可以防止用户进程之间、用户进程与操作系统之间的互相干扰。当系统决定开始运行第二个程序时，在该程序装载到内存的时候会通过静态重定位技术修改该程序的每一个程序地址。</span></p><p><strong><span>③ 使用动态运行装入运行多个不相关程序 ( 以CDC6600、Intel8088为例)</span></strong></p><p><strong><span>方法：</span></strong><span>给每个CPU配置两个特殊硬件寄存器，通常叫做基址寄存器和界限寄存器。</span></p><p>&nbsp;</p><h4 id='2逻辑地址与物理地址'><span>2.逻辑地址与物理地址</span></h4><p>&nbsp;</p><p><strong><span>逻辑地址：</span></strong><span>编译后，每个目标模块都从0号单元开始编址，这称为该目标模块的相对地址。也称为相对地址。</span></p><p><strong><span>逻辑地址空间：</span></strong><span>当链接程序将各个模块链接成一个完整的可执行目标程序时，链接程序顺序依次按各个模块的相对地址构成统一的从0号单元开始编址的逻辑地址空间。也称虚拟地址空间。</span></p><p><strong><span>物理地址：</span></strong><span>内存中的真实地址。</span></p><p><strong><span>物理地址空间：</span></strong><span>内存中物理单元的集合，它是地址转换的最终地址。</span></p><p><strong><span>地址重定位：</span></strong><span>当装入程序将可执行代码装入内存时，必须通过地址转换将逻辑地址转换为物理地址，这一过程称为地址重定位。</span></p><p><span>操作系统通过内存部件 ( MMU )将进程的逻辑地址转换为物理地址。进程使用虚拟内存空间中的地址，操作系统在相关硬件的协助下，将它转换成真正的物理地址。逻辑地址通过页表映射到物理内存，页表由操作系统维护并被处理器引用。</span></p><p>&nbsp;</p><h4 id='3-进程的内存映像'><span>3. 进程的内存映像</span></h4><p><strong><span>进程的内存映像：</span></strong><span>当一个可执行文件调入内存运行时，就构成了进程的内存映像。</span></p><p><strong><span>要素：</span></strong></p><ul><li><p><span>代码段：程序的二进制代码，代码段是只读的，可以被多个进程共享。</span></p></li><li><p><span>数据段：程序运行时加工处理的对象，包括全局变量和静态变量。</span></p></li><li><p><span>进程控制块 ( PCB )：存放在系统区。操作系统通过PCB来控制和管理进程。 </span></p></li><li><p><span>堆：用来存放动态分配的变量。通过调用</span><code>malloc</code><span>函数动态地向高地址分配空间。</span></p></li><li><p><span>栈：用来实现函数调用。从用户空间最大地址往低地址方向增长。</span></p></li></ul><p><img src="./图片资源/3-1-1_2.png" style="zoom:60%;" /></p><p><span>如上图，是一个进程在内存中的映像。</span></p><ul><li><p><span>共享库：用于存放进程用到的共享函数库代码。</span></p></li><li><p><span>只读代码：</span></p><ul><li><p><code>.init</code><span>：程序初始化时调用的</span><code>_init</code><span>函数。</span></p></li><li><p><code>.text</code><span>：用户程序的机器代码。</span></p></li><li><p><code>.rodata</code><span>：只读数据。</span></p></li><li><p><code>.data</code><span>：已初始化的全局变量和静态变量。</span></p></li><li><p><code>.bss</code><span>：未初始化及所有初始化为0的全局变量和静态变量。</span></p></li></ul></li></ul><figure class='table-figure'><table><thead><tr><th><span>要素</span></th><th><span>大小扩展契机</span></th><th><span>大小收缩契机</span></th></tr></thead><tbody><tr><td><span>代码段/数据段</span></td><td><span>已被指定 无法动态更改</span></td><td><span>已被指定 无法动态更改</span></td></tr><tr><td><span>栈</span></td><td><span>某个函数被调用</span></td><td><span>从一个函数返回</span></td></tr><tr><td><span>堆(以C为例)</span></td><td><span>调用malloc函数</span></td><td><span>调用free函数</span></td></tr></tbody></table></figure><h4 id='4-内存保护'><span>4. 内存保护</span></h4><p><strong><span>方法：</span></strong></p><p><span>(1) 在CPU中设置一对上下限寄存器，存放用户作业在主存中的下限和上限地址，每当CPU要访问一个地址时，分别和两个寄存器的值相比，判断有无越界。</span></p><p><span>(2) 采用重定位寄存器 ( 又称基地址寄存器 ) 和界地址寄存器 ( 又称限长寄存器 )来实现这种保护。</span></p><p><span>	</span><span> 其中，重定位寄存器含有物理地址的最小值。界地址寄存器含有逻辑地址的最大值。</span></p><p><span>	</span><span> 注意：重定位寄存器是用来与逻辑地址相加得到物理地址的，界地址寄存器是用来比较逻辑地址是否越界的。</span></p><p><strong><span>使用重定位寄存器与界地址寄存器重定位的缺点：</span></strong></p><p><span>每次访问内存都需要进行加法和比较运算。比较运算可以做的很快，但是加法运算由于进位传递时间的问题，在没有使用特殊电路的情况下会显得很慢。</span></p><h1 id='312-覆盖与交换技术'><span>3.1.2 覆盖与交换技术</span></h1><p><strong><span>应用场景：</span></strong><span>覆盖与交换技术是在多少程序环境下用来扩充内存的两种方式。</span></p><h4 id='1-覆盖'><span>1. 覆盖</span></h4><p><strong><span>基本思想：</span></strong><span>把用户空间分成一个固定区和若干覆盖区。将经常活跃的部分放在固定区，其余部分按调用关系分段。首先将那些即将要访问的段放入覆盖区，其他段放在外存中，在需要调用前，系统在将其调入覆盖区，替换覆盖区中原有的段。</span></p><p><strong><span>备注：</span></strong><span>我们将虚拟内存分为核心空间和用户空间，内核、核心扩充和驱动程序运行在内核空间，而其他的应用程序运行在用户空间。核心空间的特权级别比用户空间要高。</span></p><p><span>假设有一程序调用结构如下图，其中模块A的调用频率最高，调用其他任何一个模块时，模块A都会被调用。模块B与C不会同时被访问，模块D、E、F不会同时被访问。</span></p><p><img src="./图片资源/3-1-2-1_1.png" style="zoom:60%;" /></p><p><span>若不使用覆盖模块，则要想将该程序全部放入内存，需要的内存总量为</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="40.981ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 18113.6 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-3-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-3-TEX-N-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path id="MJX-3-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-3-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-3-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-3-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-3-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-3-TEX-N-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-3-TEX-N-28"></use></g><g data-mml-node="mn" transform="translate(389,0)"><use data-c="38" xlink:href="#MJX-3-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(1111.2,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(2111.4,0)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-3-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(3333.7,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(4333.9,0)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use><use data-c="32" xlink:href="#MJX-3-TEX-N-32" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(5333.9,0)"><use data-c="29" xlink:href="#MJX-3-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(5945.1,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mo" transform="translate(6945.3,0)"><use data-c="28" xlink:href="#MJX-3-TEX-N-28"></use></g><g data-mml-node="mn" transform="translate(7334.3,0)"><use data-c="38" xlink:href="#MJX-3-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(8056.6,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(9056.8,0)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-3-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(10279,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(11279.2,0)"><use data-c="38" xlink:href="#MJX-3-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(11779.2,0)"><use data-c="29" xlink:href="#MJX-3-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(12390.4,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mo" transform="translate(13390.7,0)"><use data-c="28" xlink:href="#MJX-3-TEX-N-28"></use></g><g data-mml-node="mn" transform="translate(13779.7,0)"><use data-c="38" xlink:href="#MJX-3-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(14501.9,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(15502.1,0)"><use data-c="38" xlink:href="#MJX-3-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(16224.3,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(17224.6,0)"><use data-c="34" xlink:href="#MJX-3-TEX-N-34"></use></g><g data-mml-node="mo" transform="translate(17724.6,0)"><use data-c="29" xlink:href="#MJX-3-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>8</mn><mo>+</mo><mn>10</mn><mo>+</mo><mn>12</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>8</mn><mo>+</mo><mn>10</mn><mo>+</mo><mn>8</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>8</mn><mo>+</mo><mn>8</mn><mo>+</mo><mn>4</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">(8+10+12) + (8+10+8) + (8+8+4)</script><span>k。</span></p><p><span>使用覆盖技术时，按照程序内模块的调用结构，我们将模块A放入固定区，模块B、C放在同一个覆盖区，模块D、E、F放在同一个覆盖区，如下图，则将该程序全部放入内存所需的内存总量为</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="44.279ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 19571.3 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-4-TEX-N-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path id="MJX-4-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-4-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-4-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-4-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-4-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-4-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-4-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-4-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-4-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-4-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-4-TEX-N-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path id="MJX-4-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><use data-c="38" xlink:href="#MJX-4-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(722.2,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(1722.4,0)"><use data-c="1D45A" xlink:href="#MJX-4-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(2600.4,0)"><use data-c="1D44E" xlink:href="#MJX-4-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(3129.4,0)"><use data-c="1D465" xlink:href="#MJX-4-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(3701.4,0)"><use data-c="28" xlink:href="#MJX-4-TEX-N-28"></use></g><g data-mml-node="mn" transform="translate(4090.4,0)"><use data-c="31" xlink:href="#MJX-4-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-4-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(5090.4,0)"><use data-c="2C" xlink:href="#MJX-4-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(5535.1,0)"><use data-c="38" xlink:href="#MJX-4-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(6035.1,0)"><use data-c="29" xlink:href="#MJX-4-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(6646.3,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(7646.6,0)"><use data-c="1D45A" xlink:href="#MJX-4-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(8524.6,0)"><use data-c="1D44E" xlink:href="#MJX-4-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(9053.6,0)"><use data-c="1D465" xlink:href="#MJX-4-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(9625.6,0)"><use data-c="28" xlink:href="#MJX-4-TEX-N-28"></use></g><g data-mml-node="mn" transform="translate(10014.6,0)"><use data-c="31" xlink:href="#MJX-4-TEX-N-31"></use><use data-c="32" xlink:href="#MJX-4-TEX-N-32" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(11014.6,0)"><use data-c="2C" xlink:href="#MJX-4-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(11459.2,0)"><use data-c="38" xlink:href="#MJX-4-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(11959.2,0)"><use data-c="2C" xlink:href="#MJX-4-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(12403.9,0)"><use data-c="34" xlink:href="#MJX-4-TEX-N-34"></use></g><g data-mml-node="mo" transform="translate(12903.9,0)"><use data-c="29" xlink:href="#MJX-4-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(13570.7,0)"><use data-c="3D" xlink:href="#MJX-4-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(14626.4,0)"><use data-c="38" xlink:href="#MJX-4-TEX-N-38"></use></g><g data-mml-node="mo" transform="translate(15348.7,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(16348.9,0)"><use data-c="31" xlink:href="#MJX-4-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-4-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(17571.1,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(18571.3,0)"><use data-c="31" xlink:href="#MJX-4-TEX-N-31"></use><use data-c="32" xlink:href="#MJX-4-TEX-N-32" transform="translate(500,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn><mo>+</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>10</mn><mo>,</mo><mn>8</mn><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>12</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>4</mn><mo stretchy="false">)</mo><mo>=</mo><mn>8</mn><mo>+</mo><mn>10</mn><mo>+</mo><mn>12</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">8 + max(10, 8) + max(12, 8, 4) = 8 + 10 + 12</script><span>k。</span></p><p><strong><span>特点：</span></strong></p><ul><li><p><span>打破了必须将一个进程的全部信息装入主存后才能运行的限制，但当同时运行程序的代码大于主存时仍不能运行</span></p></li><li><p><span>内存中能够更新的地方只有覆盖区的段，不在覆盖区中的段会常驻内存</span></p></li><li><p><span>覆盖技术对用户和程序员不透明</span></p></li></ul><h4 id='2-交换'><span>2. 交换</span></h4><p><strong><span>基本思想：</span></strong><span>把处于等待状态的程序从内存移到辅存，把内存空间腾出来，这一过程又称为换出；把准备好竞争CPU运行的程序从辅存移到内存，这一过程又称换入。</span></p><p><strong><span>需要注意的问题：</span></strong></p><ul><li><p><span>交换需要备份存储，通常是硬盘。它必须足够大，并提供对这些内存映像的直接访问。</span></p></li><li><p><span>为了有效使用CPU，需要使每个进程的执行时间比交换时间长。</span></p></li><li><p><span>若换出进程，则必须确保该进程完全处于空闲状态。</span></p></li><li><p><span>交换空间通常作为磁盘的一整块，且独立于文件系统，因此使用起来可能很快。</span></p></li><li><p><span>交换通常在有许多进程运行且内存空间吃紧时开始启动，而在系统负荷降低时就暂停。</span></p></li><li><p><span>普通的交换使用不多，但交换策略的某些变体在许多系统(如UNIX)中仍发挥作用。</span></p></li></ul><p>&nbsp;</p><h1 id='313-连续分配管理方式'><span>3.1.3 连续分配管理方式</span></h1><p>&nbsp;</p><p><strong><span>概念：</span></strong><span>指系统为用户分配一个</span><font color=red><span>连续的</span></font><span>内存空间（操作系统从用户空间中切割出一段连续的空间作为一个新的分区，供用户使用）</span></p><p><strong><span>内部碎片与外部碎片的区别：</span></strong></p><ul><li><p><span>内部碎片是分区分配方式中，划分出来的某个分区内无法被利用的内存块。</span></p></li><li><p><span>外部碎片是分区分配方式中，用户空间中无法被利用的内存块。</span></p></li></ul><h4 id='1-单一连续分配'><span>1. 单一连续分配</span></h4><p><strong><span>思想：</span></strong><span>内存被分为系统区和用户区。系统区通常在低地址部分，仅供操作系统使用；用户区中，每次装入仅装入一道用户程序，整个内存的用户空间由该程序独占。</span></p><p><strong><span>优点：</span></strong><span>简单、无外部碎片，无需进行内存保护。</span></p><p><strong><span>缺点：</span></strong><span>只能用于单用户、单任务的操作系统中，有内部碎片，存储器的利用率极低。</span></p><p><img src="./图片资源/3-1-3_1.png" style="zoom:67%;" /></p><h4 id='2-固定分区分配'><span>2. 固定分区分配</span></h4><p><strong><span>思想：</span></strong><span>将用户内存空间划分为若干大小固定的区域，每个分区只装入一道作业。当有空闲分区时，便可再从外存的后备作业队列中选择适当大小的作业装入该分区。</span></p><p><strong><span>两种划分分区的方法：</span></strong></p><ul><li><p><span>分区大小相等：程序太小会造成浪费，程序太大又无法装入，缺乏灵活性。</span></p></li><li><p><span>分区大小不等：划分为多个较小的分区、适量的中等分区和少量大分区。</span></p></li></ul><p><strong><span>管理分区的方式：</span></strong><span>建立分区使用表，通常按分区大小排列。表中每一项包括每个分区的起始地址、大小以及分配状态。如下表，每次分配内存，只需检索该表，若可以找到一个未分配的符合要求的分区，则将相应表项状态修改为&quot;已分配&quot;；若否，则拒绝分配内存。 </span></p><figure class='table-figure'><table><thead><tr><th><span>分区号</span></th><th><span>大小/KB</span></th><th><span>起始地址/KB</span></th><th><span>状态</span></th></tr></thead><tbody><tr><td><span>1</span></td><td><span>12</span></td><td><span>20</span></td><td><span>已分配</span></td></tr><tr><td><span>2</span></td><td><span>32</span></td><td><span>32</span></td><td><span>已分配</span></td></tr><tr><td><span>3</span></td><td><span>64</span></td><td><span>64</span></td><td><span>已分配</span></td></tr><tr><td><span>4</span></td><td><span>128</span></td><td><span>128</span></td><td><span>未分配</span></td></tr></tbody></table></figure><p><span> </span></p><h4 id='3-动态分区分配'><span>3. 动态分区分配</span></h4><p><strong><span>思想：</span></strong><span>在程序装入内存时，根据进程的实际需要，动态地分配内存，使得分区的大小刚好可以满足进程的需要。因此，系统中分区的大小和数目都是可变的。</span></p><p><strong><span>外部碎片：</span></strong><span>随着用户空间被不断地分割、回收，较长一段时间后，内存中会产生大量小内存块无法被利用，即产生大量外部碎片。</span></p><p><strong><span>紧缩技术：</span></strong><span>为了解决上面的外部碎片问题，提高内存的利用率，可以通过紧缩技术，由操作系统不时地对进程进行移动和整理。该技术需要动态重定位寄存器的支持，且相对费时。</span></p><p><span>假设有如下用户空间目标分配状态，其中分区A占8个单位，分区B占5个内存单位，分区C占12个单位：</span></p><p><img src="./图片资源/3-1-3_2.png" style="zoom:67%;" /></p><ul><li><p><span>分配内存：操作系统按照堆栈的方式，依次将分区A、B、C压入用户空间堆栈，并维护一个始终指向高地址（栈顶）的栈指针。</span></p></li><li><p><span>回收内存：存在两种触发时机，一是每次用户（广义，包括进程等，下同）释放内存时，二是用户空间不足或栈顶指针指向用户空间最高地址时。</span></p><ol start='' ><li><p><span>计算分区的新地址。设立两个指针随巡查移动，分别用于指向内存紧缩后分区的原地址和新地址。因此，分区的第一个内存单位需要在分区大小和标志域外，新增一用于存储紧缩后应有的新地址的地址域（即建立一新旧地址对照表）</span></p></li><li><p><span>修改用户初始变量。保证内存紧缩后，用户可以找到自己的地址。</span></p></li><li><p><span>检查各分区存储的数据，若有指向其他分区的指针，修改之。</span></p></li><li><p><span>将分区迁移到紧缩后的新地址。</span></p></li><li><p><span>更新栈顶指针的值。</span></p></li></ol></li></ul><p><span>可见，紧缩技术相当复杂，因此非迫不得已不会使用。</span></p><h5 id='动态分区分配策略'><span>动态分区分配策略</span></h5><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>算法</span></th><th style='text-align:left;' ><span>思想</span></th><th style='text-align:left;' ><span>优点</span></th><th><span>缺点</span></th><th style='text-align:center;' ><span>算法</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><span>首次适应/首次适配算法</span></td><td style='text-align:left;' ><span>空闲分区以地址递增的次序链接。分配内存时，从链首开始顺序查找，找到大小能够满足要求的第一个空闲分区分配给作业。</span></td><td style='text-align:left;' ><span>最简单、通常是最快、最好的。</span></td><td><span>会使低地址部分出现很多很小的空闲分区，而每次查找都需要经过这些分区，增大了开销。</span></td><td style='text-align:center;' ><span>建立一个双向链表，初始时，该链表头指针和尾指针重合。开始分配时，按照所需分区大小建立新的节点，查找策略见&quot;思想&quot;。内存回收时，需要查询该节点能否与前后节点合并。</span></td></tr><tr><td style='text-align:left;' ><span>临近适应/下次适配算法</span></td><td style='text-align:left;' ><span>与首次适应算法相似，但每次查找的起始地址并非从最低地址开始，而是从上次查找到地方开始搜索。</span></td><td style='text-align:left;' ><span>节省了首次适应算法从头开始查找所需的开销</span></td><td><span>通常会导致用户空间尾部分裂成小碎片，性能通常比首次适应算法略差。</span></td><td style='text-align:center;' ><span>类似首次适应算法，但使用一个双向循环链表来记录而非双向链表。此外，还需要一个特别的指针来标记当前查找到的位置。</span></td></tr><tr><td style='text-align:left;' ><span>最佳适应/最佳适配算法</span></td><td style='text-align:left;' ><span>需要将空闲分区按大小递增排序，找到第一个能够满足需求的分区分配给作业。</span></td><td style='text-align:left;' ><span>可以尽可能保留大分区</span></td><td><span>由于每次优先使用较小的分区，随着内存的使用，会产生越来越多、很小的、难以处理的外部碎片。此外，由于需要维护一个有序的空闲分区大小排列，算法性能很差。</span></td><td style='text-align:center;' ><span>可用小根堆对空闲分区进行排序。由于并非严格按照地址高低顺序进行分配，两个空闲区块很可能不相邻，因此无法及时合并空闲区块，从而产生大量外部碎片。</span></td></tr><tr><td style='text-align:left;' ><span>最坏适应/最差适配算法</span></td><td style='text-align:left;' ><span>类似最佳适应算法，但是对空闲分区进行排序时是按照从大到小的顺序排序。</span></td><td style='text-align:left;' ><span>可以减少难以利用的、很小的空闲分区碎片的数量</span></td><td><span>会很快导致没有可以使用的大空闲分区。算法性能很差（原因同上）</span></td><td style='text-align:center;' ><span>类似最佳适应算法，但可使用大根堆进行排序。</span></td></tr></tbody></table></figure></div></div>
</body>
</html>
